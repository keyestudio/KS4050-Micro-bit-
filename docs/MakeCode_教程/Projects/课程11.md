### 3.3.11 基于Micro:bit的多传感器OLED监控平台

#### 3.3.11.1 简介

![Img](./media/top1.png)

在本项目实验中，利用Micro:bit主板作为核心处理单元，读取其内置传感器(例如：Micro:bit光线传感器，Micro:bit温度传感器和Micro:bit麦克风)及外接传感器(例如：PM2.5粉尘传感器、水滴传感器、火焰传感器和太阳紫外线传感器)的数据，并通过I2C接口的OLED显示屏进行实时、直观的显示。

![Img](./media/bottom1.png)

#### 3.3.11.2 所需组件

| ![Img](./media/microbitV2.png)| ![Img](./media/ExpansionBoard.png) |![Img](./media/OLED.png)| 
| :--: | :--: | :--: |
| micro:bit主板 ×1 | micro:bit传感器扩展板 ×1 |OLED显示屏 ×1 |
|![Img](./media/PM2.5-1.png) |![Img](./media/fire2.png)|![Img](./media/steam1.png)|
| PM2.5粉尘传感器 ×1|火焰传感器 ×1 |水滴传感器 ×1 |
|![Img](./media/UV-sensor1.png)|![Img](./media/batterycase.png)| ![Img](./media/AAbattery.png)|
|太阳紫外线传感器 ×1|电池盒 ×1|AA电池(**自备**) ×6|
|![Img](./media/4pin-1.png) |![Img](./media/4pin.png)|![Img](./media/3pin.png)|
|4 pin 线材(红黑蓝绿) ×1|4 pin 线材(黑红蓝绿) ×1 |3 pin 线材 ×3 |
|![Img](./media/usb.png) | | |
| micro USB 线 ×1| | |

#### 3.3.11.3 接线图

⚠️ **特别注意：接线时，请注意区分线材颜色。**

|太阳紫外线传感器| 线材颜色 | micro:bit传感器扩展板引脚 |micro:bit主板引脚 |
| :--: | :--: | :--: | :--: |
| G | 黑线 | G | G |
| V | 红线 | V2 | V |
| S | 黄线 | 0 | P0 |

| 火焰传感器 | 线材颜色 | micro:bit传感器扩展板引脚 |micro:bit主板引脚 |
| :--: | :--: | :--: | :--: |
| G | 黑线 | G | G |
| V | 红线 | V2 | V |
| D | 黄线 | 16 | P16 |

|水滴传感器| 线材颜色 | micro:bit传感器扩展板引脚 |micro:bit主板引脚 |
| :--: | :--: | :--: | :--: |
| G | 黑线 | G | G |
| V | 红线 | V1 | V |
| S | 黄线 | 1 | P1 |

| PM2.5粉尘传感器 | 线材颜色 | micro:bit传感器扩展板引脚 |micro:bit主板引脚 |
| :--: | :--: | :--: | :--: |
| VCC | 红线 | V2 | V |
| GND | 黑线 | G | G |
| LED | 蓝线 | 9 | P9 |
| OUT | 绿线 | 2 | P2 |

| OLED显示屏 | 线材颜色 | micro:bit传感器扩展板引脚 |micro:bit主板引脚 |
| :--: | :--: | :--: | :--: |
| GND | 黑线 | G | G |
| VCC | 红线 | V2 | V |
| SDA | 蓝线 | 20 | P20 |
| SCL | 绿线 | 19 | P19 |

![Img](./media/couj11.png)

#### 3.3.11.4 代码流程图

![Img](./media/flow-chart-11.png)

#### 3.3.11.5 实验代码

**完整代码：**

![Img](./media/couj011.png)


![Img](./media/line1.png)

**简单说明：**

① 初始化OLED显示屏的像素，OLED清屏，Microbit主板上的5×5LED点阵显示图案![Img](./media/ab3.png)，定义变量UV、Rain、Temperature、Light、Sound与pm2.5_dust的初始值为0。

![Img](./media/cou42.png)

② 读取光线强度，温度，噪音强度，雨水量强度和太阳光紫外线强度。

![Img](./media/cou43.png)

③ 这是if()...else...的判断语句。

当火焰传感器检测到火焰时，OLED显示字符串 “Have a fire” ；否则，OLED显示字符串 “No fire”。

![Img](./media/cou44.png)

④ OLED显示屏显示太阳光紫外线强度，温度，雨水量强度，光线强度，噪音强度和PM2.5粉尘浓度。

![Img](./media/cou45.png)

#### 3.3.11.6 实验结果

![Img](./media/4top.png)

下载代码，使用Windows 10 App下载代码只需单击 “下载” 按钮即可，使用浏览器下载代码则需要将下载的 “hex” 文件发送到micro:bit主板。

示例代码成功下载到micro:bit主板之后，利用micro USB数据线上电，同时还需要外接电源(6个AA电池安装到电池盒，保证电源充足)。

读取Micro:bit主板内置传感器(例如：Micro:bit光线传感器，Micro:bit温度传感器和Micro:bit麦克风)及外接传感器(例如：PM2.5粉尘传感器、水滴传感器、火焰传感器和太阳紫外线传感器)检测到的相关数据，并通过I2C接口的OLED显示屏进行实时、直观的显示。

![Img](./media/4bottom.png)





